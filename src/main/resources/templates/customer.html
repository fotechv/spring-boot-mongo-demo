<!doctype html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Customers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
<div class="container">
    <nav class="mb-4 d-flex gap-2">
        <a href="/customer" class="btn btn-primary">Customer</a>
        <a href="/transaction" class="btn btn-outline-primary">Transaction</a>
    </nav>

    <div class="d-flex align-items-end gap-2 mb-3">
        <div>
            <label for="seedCount" class="form-label mb-1">Seed count</label>
            <input id="seedCount" type="number" value="50" min="1" class="form-control" style="width:140px" />
        </div>
        <button id="seedBtn" class="btn btn-success">Tạo dữ liệu tự động</button>
        <button id="reloadBtn" class="btn btn-secondary">Reload danh sách</button>
    </div>

    <div class="card mb-4">
        <div class="card-header">Kết quả seed</div>
        <div class="card-body">
            <pre id="out" class="mb-0">(chưa có)</pre>
        </div>
    </div>

    <div class="d-flex align-items-end gap-2 mb-2">
        <div>
            <label for="page" class="form-label mb-1">Page</label>
            <input id="page" type="number" value="0" min="0" class="form-control" style="width:120px" />
        </div>
        <div>
            <label for="size" class="form-label mb-1">Size</label>
            <input id="size" type="number" value="10" min="1" class="form-control" style="width:120px" />
        </div>
        <button id="loadBtn" class="btn btn-primary">Load</button>
    </div>

    <div class="table-responsive">
        <table class="table table-striped table-bordered align-middle">
            <thead class="table-dark">
            <tr><th style="width:36%">ID</th><th style="width:32%">Name</th><th style="width:32%">Email</th></tr>
            </thead>
            <tbody id="tbody"></tbody>
        </table>
    </div>
    <div id="pager" class="text-muted small"></div>
</div>

<script>
    async function loadCustomers() {
        const page = document.getElementById('page').value || 0;
        const size = document.getElementById('size').value || 10;
        const res = await fetch(`/api/customers?page=${page}&size=${size}`);
        const data = await res.json();

        const tbody = document.getElementById('tbody');
        tbody.innerHTML = '';
        data.content.forEach(c => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${c.id ?? ''}</td><td>${c.name ?? ''}</td><td>${c.email ?? ''}</td>`;
            tbody.appendChild(tr);
        });
        document.getElementById('pager').textContent =
            `page=${data.number} / totalPages=${data.totalPages} • totalElements=${data.totalElements}`;
    }

    document.getElementById('seedBtn').addEventListener('click', async () => {
        const count = document.getElementById('seedCount').value || 50;
        const res = await fetch(`/api/customers/seed?count=${count}`, { method: 'POST' });
        const json = await res.json();
        document.getElementById('out').textContent = JSON.stringify(json, null, 2);
        loadCustomers();
    });

    document.getElementById('loadBtn').addEventListener('click', loadCustomers);
    document.getElementById('reloadBtn').addEventListener('click', loadCustomers);

    // load lần đầu
    loadCustomers();
</script>
</body>
</html>
